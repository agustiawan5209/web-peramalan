import{r as m,j as e}from"./app-CwzCkPZf.js";import{L as E,I as M}from"./label-DbovscGM.js";import{T as g,a as $,b as h,c as w,d as j,e as d}from"./table-hQ7uTzO3.js";import{f as H}from"./fpgrowth-CgZhDACL.js";import"./utils-jAU0Cazi.js";import"./index-BsY3OrU1.js";import"./index-B0Fnjf-p.js";const V=({transactions:r,support_threshold:y,confidence_threshold:k,setSupportThreshold:R,setConfidenceThreshold:G})=>{const[a,J]=m.useState({all:[],tinggi:[],rendah:[],sedang:[]}),[c,T]=m.useState(!1),[f,F]=m.useState(null),i=m.useRef(null),A=async()=>{i.current&&clearTimeout(i.current),F(null),i.current=setTimeout(()=>T(!0),1e3);try{if(r.length===0)throw new Error("Tidak ada transaksi untuk diproses");const t=await new H.FPGrowth(y/100).exec(r),N=r.length,P=new Map;t.forEach(n=>{const l=n.support/N*100;P.set(n.items.sort().join(","),l)});const b=[],C=new Set;t.forEach(n=>{if(n.items.length<2)return;const l=n.items;for(let v=1;v<(1<<l.length)-1;v++){const u=[],p=[];for(let o=0;o<l.length;o++)v&1<<o?u.push(l[o]):p.push(l[o]);if(p.length!==1)continue;const S=[...u,...p].sort().join(",");if(C.has(S))continue;C.add(S);const L=u.sort().join(","),_=P.get(L);if(!_)continue;const q=n.support/(_*N/100)*100;q>=k&&b.push({antecedent:u,consequent:p[0],confidence:q,support:n.support/N*100})}}),console.log(b);const I=["hasil_panen_sedang","hasil_panen_rendah","hasil_panen_sedang"],x=b.filter(n=>I.includes(n.consequent)).sort((n,l)=>l.confidence-n.confidence||l.support-n.support);J({all:x,tinggi:x.filter(n=>n.consequent==="hasil_panen_sedang"),rendah:x.filter(n=>n.consequent==="hasil_panen_rendah"),sedang:x.filter(n=>n.consequent==="hasil_panen_sedang")})}catch(s){F(s instanceof Error?s.message:"Terjadi kesalahan saat memproses data"),console.error("FP-Growth Error:",s)}finally{T(!1),i.current&&clearTimeout(i.current)}};return m.useEffect(()=>()=>{i.current&&clearTimeout(i.current)},[]),e.jsxs("div",{className:"mx-auto max-w-7xl px-4 py-12 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Hasil Aturan Asosiasi FP-Growth"}),e.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[e.jsx("p",{className:"font-medium text-yellow-600",children:"Peringatan: Proses ini mungkin memakan waktu lama jika data transaksi sangat besar"}),e.jsxs("p",{className:"mt-1",children:[e.jsx("span",{className:"font-semibold",children:"Support Threshold:"})," Minimum support (0-100%) untuk itemset dianggap frequent"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Confidence Threshold:"})," Minimum confidence (0-100%) untuk aturan dianggap valid"]})]})]}),e.jsxs("div",{className:"mb-6 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{htmlFor:"support_threshold",className:"w-40",children:"Support Threshold (%)"}),e.jsx(M,{id:"support_threshold",type:"number",min:"0",max:"100",step:"1",value:y,onChange:s=>R(Math.min(100,Math.max(0,Number(s.target.value)))),className:"w-24"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{htmlFor:"confidence_threshold",className:"w-40",children:"Confidence Threshold (%)"}),e.jsx(M,{id:"confidence_threshold",type:"number",min:"0",max:"100",step:"1",value:k,onChange:s=>G(Math.min(100,Math.max(0,Number(s.target.value)))),className:"w-24"})]})]}),e.jsx("button",{onClick:A,disabled:c||r.length===0,className:`rounded-md px-4 py-2 font-medium text-white ${c||r.length===0?"cursor-not-allowed bg-gray-400":"bg-blue-600 hover:bg-blue-700"} transition-colors`,children:c?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{className:"h-4 w-4 animate-spin rounded-full border-b-2 border-white"}),"Memproses..."]}):"Jalankan FP-Growth"})]}),r.length===0&&e.jsx("div",{className:"mb-6 rounded-md bg-yellow-50 p-4 text-yellow-800",children:"Tidak ada data transaksi untuk diproses"}),f&&e.jsx("div",{className:"mb-6 rounded-md bg-red-50 p-4 text-red-800",children:f}),!c&&a.all.length>0&&e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"mb-2 text-lg font-medium text-gray-900",children:["Semua Aturan (",a.all.length," ditemukan)"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(g,{className:"min-w-full divide-y divide-gray-200",children:[e.jsx($,{className:"bg-gray-50",children:e.jsxs(h,{children:[e.jsx(w,{className:"w-2/3",children:"Aturan"}),e.jsx(w,{className:"text-center",children:"Confidence"}),e.jsx(w,{className:"text-center",children:"Support"})]})}),e.jsx(j,{className:"divide-y divide-gray-200",children:a.all.slice(0,50).map((s,t)=>e.jsxs(h,{children:[e.jsxs(d,{className:"py-3",children:[e.jsx("span",{className:"font-medium",children:"Jika "}),e.jsx("span",{className:"font-semibold text-blue-600",children:s.antecedent.join(" ∧ ")}),e.jsx("span",{className:"font-medium",children:" maka "}),e.jsx("span",{className:"font-semibold text-green-600",children:s.consequent})]}),e.jsxs(d,{className:"text-center",children:[s.confidence.toFixed(1),"%"]}),e.jsxs(d,{className:"text-center",children:[s.support.toFixed(1),"%"]})]},t))})]})})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[e.jsxs("div",{className:"overflow-hidden rounded-lg border",children:[e.jsx("div",{className:"border-b bg-green-50 p-3",children:e.jsxs("h4",{className:"font-medium text-green-800",children:["Panen Tinggi (",a.tinggi.length," aturan)"]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:a.tinggi.length>0?e.jsx(g,{children:e.jsx(j,{children:a.tinggi.slice(0,10).map((s,t)=>e.jsx(h,{children:e.jsxs(d,{className:"px-4 py-2",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Jika "}),s.antecedent.join(" ∧ ")]}),e.jsxs("div",{className:"mt-1 flex justify-between text-xs",children:[e.jsxs("span",{children:["C: ",s.confidence.toFixed(1),"%"]}),e.jsxs("span",{children:["S: ",s.support.toFixed(1),"%"]})]})]})},`tinggi-${t}`))})}):e.jsx("div",{className:"p-4 text-sm text-gray-500",children:"Tidak ada aturan untuk Panen Tinggi"})})]}),e.jsxs("div",{className:"overflow-hidden rounded-lg border",children:[e.jsx("div",{className:"border-b bg-yellow-50 p-3",children:e.jsxs("h4",{className:"font-medium text-yellow-800",children:["Panen Sedang (",a.sedang.length," aturan)"]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:a.sedang.length>0?e.jsx(g,{children:e.jsx(j,{children:a.sedang.slice(0,10).map((s,t)=>e.jsx(h,{children:e.jsxs(d,{className:"px-4 py-2",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Jika "}),s.antecedent.join(" ∧ ")]}),e.jsxs("div",{className:"mt-1 flex justify-between text-xs",children:[e.jsxs("span",{children:["C: ",s.confidence.toFixed(1),"%"]}),e.jsxs("span",{children:["S: ",s.support.toFixed(1),"%"]})]})]})},`sedang-${t}`))})}):e.jsx("div",{className:"p-4 text-sm text-gray-500",children:"Tidak ada aturan untuk Panen Sedang"})})]}),e.jsxs("div",{className:"overflow-hidden rounded-lg border",children:[e.jsx("div",{className:"border-b bg-red-50 p-3",children:e.jsxs("h4",{className:"font-medium text-red-800",children:["Panen Rendah (",a.rendah.length," aturan)"]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:a.rendah.length>0?e.jsx(g,{children:e.jsx(j,{children:a.rendah.slice(0,10).map((s,t)=>e.jsx(h,{children:e.jsxs(d,{className:"px-4 py-2",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Jika "}),s.antecedent.join(" ∧ ")]}),e.jsxs("div",{className:"mt-1 flex justify-between text-xs",children:[e.jsxs("span",{children:["C: ",s.confidence.toFixed(1),"%"]}),e.jsxs("span",{children:["S: ",s.support.toFixed(1),"%"]})]})]})},`rendah-${t}`))})}):e.jsx("div",{className:"p-4 text-sm text-gray-500",children:"Tidak ada aturan untuk Panen Rendah"})})]})]})]}),!c&&!f&&a.all.length===0&&r.length>0&&e.jsxs("div",{className:"rounded-lg bg-gray-50 p-8 text-center",children:[e.jsx("p",{className:"text-gray-600",children:"Tidak ada aturan yang ditemukan dengan threshold saat ini."}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Coba turunkan nilai support atau confidence threshold."})]})]})};export{V as default};
